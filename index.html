<!DOCTYPE html>
<html lang="ru"><head><meta charset="UTF-8"><title>index.html</title><script src="https://cdn.tailwindcss.com"></script></head>
<body class="max-w-3xl mx-auto px-4 py-6 bg-gray-50 min-h-screen">

<nav class="bg-gray-800 p-4 text-white flex justify-between items-center mb-6">
  <div class="space-x-4">
    <a href="index.html" class="hover:underline">Компании</a>
    <a href="issue.html" class="hover:underline">Выпуск</a>
    <a href="transfer.html" class="hover:underline">Перемещение</a>
    <a href="log.html" class="hover:underline">Журнал</a>
    <a href="history.html" class="hover:underline">История</a>
  </div>
  <div>
    <span id="userStatus" class="mr-4 text-sm italic"></span>
    <button id="logoutBtn" class="bg-red-600 px-3 py-1 rounded text-sm">Выйти</button>
  </div>
</nav>

<h1 class='text-2xl font-bold mb-4'>Создание компании</h1><p>Здесь будет форма создания компании.</p>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
  import {
    getAuth,
    signInWithEmailAndPassword,
    createUserWithEmailAndPassword,
    signOut,
    onAuthStateChanged
  } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";

  const firebaseConfig = {
    apiKey: "AIzaSyCfCnM8w7DZKZN3dXZgDHUo9RSx1K2y6mo",
    authDomain: "carbonunitsregistry.firebaseapp.com",
    databaseURL: "https://carbonunitsregistry-default-rtdb.europe-west1.firebasedatabase.app",
    projectId: "carbonunitsregistry",
    storageBucket: "carbonunitsregistry.firebasestorage.app",
    messagingSenderId: "1096076583239",
    appId: "1:1096076583239:web:9a3b9425c66b927981ec62",
    measurementId: "G-EJCZMFZQ0G"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);

  const path = window.location.pathname;
  const navUser = document.getElementById('userStatus');
  const logoutBtn = document.getElementById('logoutBtn');

  onAuthStateChanged(auth, (user) => {
    if (user) {
      if (navUser) navUser.textContent = "Вы вошли как: " + user.email;
      if (logoutBtn) logoutBtn.onclick = () => signOut(auth).then(() => location.href = 'login.html');
    } else {
      if (!path.includes('login') && !path.includes('register')) {
        location.href = 'login.html';
      }
    }
  });

  if (path.includes("login")) {
    document.getElementById("loginBtn").onclick = () => {
      const email = document.getElementById("email").value;
      const password = document.getElementById("password").value;
      signInWithEmailAndPassword(auth, email, password)
        .then(() => location.href = "index.html")
        .catch(err => alert("Ошибка: " + err.message));
    };
  }

  if (path.includes("register")) {
    document.getElementById("registerBtn").onclick = () => {
      const email = document.getElementById("email").value;
      const password = document.getElementById("password").value;
      createUserWithEmailAndPassword(auth, email, password)
        .then(() => location.href = "index.html")
        .catch(err => alert("Ошибка: " + err.message));
    };
  }
</script>

</body></html>